<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTW Oracle 5 &#8594; 6 @ Shukularuni</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="icon" type="image/x-icon" href="/icon.png">
</head>
<body>
    <header>
        <h1>UnderTheWire Oracle Guide</h1>
        <p>here's how to solve the Oracle level 5 &#8594; 6</p>
    </header>
    <main>
        <section>
            <a href="./">Back to the Oracle Guides</a>
            <p>Previous Level Guide: <a href="4.html">Oracle Level 4 &#8594; 5</a></p>
            <hr>
            <h2>Access</h2>
            <p>SSH: <code>ssh oracle5@oracle.underthewire.tech -p 22</code></p>
            <p>Password: <code>alpha83</code></p>
            <h2>Info</h2>
            <pre>The password for oracle6 is the name of the GPO that contains a description of “I_AM_GROOT” PLUS the name of the file on the user’s desktop.

NOTE:
– If you are using SSH, you MUST do a Help on the cmdlet needed to solve this. For example, if the cmdlet is “get-something” type “help get-something” first, this will make the cmdlet available for you to use. This is a bug in the SSH software used.
– If the GPO description is “blob” and the file on the desktop is named “1234”, the password would be “blob1234”.
– The password will be lowercase no matter how it appears on the screen.

&#9660; HINT:

https://learn.microsoft.com/en-us/powershell/module/activedirectory/?view=windowsserver2016-ps</pre>
            <h2>Theory</h2>
            <p>To get the password, as the description says, we have to get name of the GPO on the system that has that exact description. So, just like the previous level, we can use the Get-GPO command with the option for all modules to get all GPO's, then we can search for that description with Where-Object, I don't exactly remember what option to use when the message is equal and not just `like`, so we'll see that later. We'll also use dir to view the name of the file in the Desktop that the description tells us to join to the final password. We can see all GPO's with this command:</p>
            <pre>Get-GPO -All</pre>
            <h2>Solution</h2>
            <p>Now that we are inside of the shell, let's see the name of the file:</p>
            <pre>PS C:\users\Oracle5\desktop&gt; dir

    Directory: C:\users\Oracle5\desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018  10:50 AM              0 1337</pre>
            <p>Now let's search for a GPO with the exact description as "I_AM_GROOT" with the -eq option that I found while you weren't looking:</p>
            <pre>PS C:\users\Oracle5\desktop&gt; Get-GPO -All | Where-Object {$_.Description -eq "I_AM_GROOT"}


DisplayName      : Charlie
DomainName       : underthewire.tech
Owner            : underthewire\Domain Admins
Id               : 44080cf1-1053-467d-b000-2ea3f27dbbfa
GpoStatus        : AllSettingsEnabled
Description      : I_am_Groot
CreationTime     : 11/20/2018 12:18:09 AM
ModificationTime : 11/20/2018 12:18:08 AM
UserVersion      : AD Version: 0, SysVol Version: 0
ComputerVersion  : AD Version: 0, SysVol Version: 0
WmiFilter        :</pre>
            <p>There we go, now that we have both the GPO and the name of the file, we can join them in lowercase:</p>
            <pre>charlie1337</pre>
            <a target="_blank" href="https://underthewire.tech/oracle-5">https://underthewire.tech/oracle-5</a>
            <hr>
            Next Level Guide: <a href="6.html">Oracle Level 6 &#8594; Level 7</a>
        </section>
        <section class="link-list">
            <h2>Explore My Website</h2>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/search.html">Search</a></li>
                <li><a href="/articles.html">Articles</a></li>
                <li><a href="/guides.html">Guides</a></li>
            </ul>
            <br><br><br>
        </section>
    </main>
    <footer>
        <p class="cute">Made with ❤️ by Shukularuni</p>
    </footer>
</body>
</html>