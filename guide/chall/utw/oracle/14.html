<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTW Oracle 14 &#8594; 15 @ Shukularuni</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="icon" type="image/x-icon" href="/icon.png">
</head>
<body>
    <header>
        <h1>UnderTheWire Oracle Guide</h1>
        <p>here's how to solve the Oracle level 14 &#8594; 15</p>
    </header>
    <main>
        <section>
            <a href="./">Back to the Oracle Guides</a>
            <p>Previous Level Guide: <a href="13.html">Oracle Level 13 &#8594; 14</a></p>
            <hr>
            <h2>Access</h2>
            <p>SSH: <code>ssh oracle14@oracle.underthewire.tech -p 22</code></p>
            <p>Password: <code>gamora88</code></p>
            <h2>Info</h2>
            <pre>The password for oracle15 is the name of the user who added the user Bereet to the Galaxy security group as depicted in the event logs on the desktop PLUS the name of the text file on the user’s desktop.

NOTE:
– If the script name is “randy” and the file on the desktop is named “1234”, the password would be “randy1234”.
– The password will be lowercase no matter how it appears on the screen.

&#9660; HINT:

https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.diagnostics/get-winevent</pre>
            <h2>Theory</h2>
            <p>To get the final password, as the description says, we have to get the user account that added the user "Bereet" to the aforementioned "Galaxy" group (on the previous level Oracle14), as it would say on the Windows Event file. We've got no clue of where to start to search so we'll first look for anything with the message having words like added to group, to see all group additions, and we can continue from there on the solution. We'll also use dir to see the name of the file in the Desktop. The command would look like this:</p>
            <pre>Get-WinEvent -Path .\FILE-NAME-HERE.EVTX | Where-Object {$_.Message -like '*added*to*group*'}</pre>
            <h2>Solution</h2>
            <p>Now that we are inside of the shell, we'll first use the dir command to see the file in the Desktop for the second part of the final password, and to also know what the Windows Event file is called:</p>
            <pre>PS C:\users\Oracle14\desktop&gt; dir

    Directory: C:\users\Oracle14\desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018  10:51 AM              0 2112
-a----        8/30/2018   5:52 AM        2166784 security.evtx</pre>
            <p>Now that we know the name of the file, we'll run the command from theory to check for any additions to groups:</p>
            <pre>PS C:\users\Oracle14\desktop&gt; Get-WinEvent -Path .\security.evtx | Where-Object {$_.Message -like '*added*to*group*'}

   ProviderName: Microsoft-Windows-Security-Auditing

TimeCreated                     Id LevelDisplayName Message
-----------                     -- ---------------- -------
5/19/2017 1:19:28 AM          4728 Information      A member was added to a ...
5/19/2017 1:17:11 AM          4728 Information      A member was added to a ...
5/19/2017 1:16:54 AM          4728 Information      A member was added to a ...
5/19/2017 1:06:18 AM          4728 Information      A member was added to a ...
5/19/2017 1:04:19 AM          4728 Information      A member was added to a ...
5/19/2017 12:03:50 AM         4732 Information      A member was added to a ...
5/19/2017 12:02:56 AM         4732 Information      A member was added to a ...</pre>
            <p>Alright, that are a lot of logs, instead of going through them manually, we'll add the ExpandProperty option just like in the previous level so that we see all information about each of these logs, then we'll separate each log with the "`n", and finally we'll search for only those that contain "Bereet". Woah, this is becoming a long command:</p>
            <pre>PS C:\users\Oracle14\desktop&gt; Get-WinEvent -Path .\security.evtx | Where-Object {$_.Message -like '*added*to*group*'} | Select-Object -ExpandProperty Message | Where-Object {$_.Split("`n") -like '*bereet*'}
A member was added to a security-enabled global group.

Subject:
        Security ID:            S-1-5-21-2268727836-2773903800-2952248001-1622
        Account Name:           nebula
        Account Domain:         UNDERTHEWIRE
        Logon ID:               0xBD8CC7

Member:
        Security ID:            S-1-5-21-2268727836-2773903800-2952248001-1623
        Account Name:           CN=Bereet,OU=Morag,DC=UNDERTHEWIRE,DC=TECH

Group:
        Security ID:            S-1-5-21-2268727836-2773903800-2952248001-1626
        Group Name:             Galaxy
        Group Domain:           UNDERTHEWIRE

Additional Information:
        Privileges:             -</pre>
            <p>Now you can see two entries: the user that got inside the Galaxy group and the user that performed the action of getting the user in the group, we are looking for the one that got in, and that's the first one, which goes by the name "nebula", so let's enter that name and join it with the name of the file in the Desktop to get the password:</p>
            <pre>nebula2112</pre>
            <a target="_blank" href="https://underthewire.tech/oracle-14">https://underthewire.tech/oracle-14</a>
            <hr>
            Next Level Guide: <a href="15.html">Oracle Level 15</a>
        </section>
        <section class="link-list">
            <h2>Explore My Website</h2>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/search.html">Search</a></li>
                <li><a href="/articles.html">Articles</a></li>
                <li><a href="/guides.html">Guides</a></li>
            </ul>
            <br><br><br>
        </section>
    </main>
    <footer>
        <p class="cute">Made with ❤️ by Shukularuni</p>
    </footer>
</body>
</html>