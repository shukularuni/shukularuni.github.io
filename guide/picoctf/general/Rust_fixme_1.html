<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>picoCTF Rust fixme 1 @ Shukularuni</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="icon" type="image/x-icon" href="/icon.png">
</head>
<body>
    <header>
        <h1>picoCTF General Skills Guide</h1>
        <p>here's how to solve Rust fixme 1</p>
    </header>
    <main>
        <section>
            <a href="./">Back to the General Skills Guides</a>
            <hr>
            <h2>Rust fixme 1</h2>
            <pre>Name: Rust fixme 1
Description: Have you heard of Rust? Fix the syntax errors in this Rust file to print the flag! Download the Rust code here.
Author: Taylor McCampbell
Tags: Easy, General Skills, picoCTF 2025
Challenge from: picoCTF 2025
Files: fixme1.tar.gz
Hints:
1. Cargo is Rust's package manager and will make your life easier. See the getting started page <a target="_blank" href="https://doc.rust-lang.org/book/ch01-03-hello-cargo.html">here</a>
2. <a target="_blank" href="https://doc.rust-lang.org/std/macro.println.html">println!</a>
3. Rust has some pretty great compiler error messages. Read them maybe?</pre>
            <h2>Theory</h2>
            <p>According to the description, to get the flag we to download some rust code, and fix the errors. Before doing that, comes the hard part, setting up rust. I used Replit, which is a platform to run many programming languages online, including rust, and believe me, I tried installing rust at first, but was met with a lot of dead ends, downloaded 4.5 gigabytes of content, and didn't really get to actually run it, so I just used Replit, which everything is already set up, and I just had to paste the code and libraries (which it downloads automatically) from the tar file. And when you create the project, it's instantly public, which I am so sorry, but I missed that for the entire competition, I literally had the rust codes public on my Replit already solved and with the flags on it, so I could've been disqualified, but luckily nobody noticed my mistake, which you can find <a target="_blank" href="https://archive.org/download/sh_w_imgstff_fgunp/picoctf/Rust_fixme_1/">here</a>, just ignore the name of the repl. Anyways, onto the actual challenge.</p>
            <h2>Solution</h2>
            <p>First let's paste our code:</p>
            <pre>use xor_cryptor::XORCryptor;

fn main() {
    // Key for decryption
    let key = String::from("CSUCKS") // How do we end statements in Rust?

    // Encrypted flag values
    let hex_values = ["41", "30", "20", "63", "4a", "45", "54", "76", "01", "1c", "7e", "59", "63", "e1", "61", "25", "7f", "5a", "60", "50", "11", "38", "1f", "3a", "60", "e9", "62", "20", "0c", "e6", "50", "d3", "35"];

    // Convert the hexadecimal strings to bytes and collect them into a vector
    let encrypted_buffer: Vec&lt;u8&gt; = hex_values.iter()
        .map(|&amp;hex| u8::from_str_radix(hex, 16).unwrap())
        .collect();

    // Create decrpytion object
    let res = XORCryptor::new(&amp;key);
    if res.is_err() {
        ret; // How do we return in rust?
    }
    let xrc = res.unwrap();

    // Decrypt flag and print it out
    let decrypted_buffer = xrc.decrypt_vec(encrypted_buffer);
    println!(
        ":?", // How do we print out a variable in the println function? 
        String::from_utf8_lossy(&amp;decrypted_buffer)
    );
}</pre>
            <p>So right off the bat, we can see that there are three comments highlighting the three errors in the code. How do we end statements in Rust? With a semicolon (;). How do we return in rust? Using `return;`. How do we print out a variable in the println function? In that example specifically we can use `{:?}`. Also I'm gonna remove all the comments for no reason at all:</p>
            <pre>use xor_cryptor::XORCryptor;

fn main() {
    let key = String::from("CSUCKS");

    let hex_values = ["41", "30", "20", "63", "4a", "45", "54", "76", "01", "1c", "7e", "59", "63", "e1", "61", "25", "7f", "5a", "60", "50", "11", "38", "1f", "3a", "60", "e9", "62", "20", "0c", "e6", "50", "d3", "35"];

    let encrypted_buffer: Vec&lt;u8&gt; = hex_values.iter()
        .map(|&amp;hex| u8::from_str_radix(hex, 16).unwrap())
        .collect();

    let res = XORCryptor::new(&amp;key);
    if res.is_err() {
        return;
    }
    let xrc = res.unwrap();

    let decrypted_buffer = xrc.decrypt_vec(encrypted_buffer);
    println!(
        "{:?}", 
        String::from_utf8_lossy(&amp;decrypted_buffer)
    );
}</pre>
            <p>And when we run this code:</p>
            <pre>    Blocking waiting for file lock on package cache
    Blocking waiting for file lock on package cache
    Blocking waiting for file lock on package cache
    Blocking waiting for file lock on package cache
   Compiling rust_proj v0.1.0 (/home/runner/workspace)
    Building [=======================&gt;   ] 11/12: rust_proj(bin)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 5.30s
     Running `target/debug/rust_proj`
"picoCTF{4r3_y0u_4_ru$t4c30n_n0w?}"</pre>
            <p>There we go! That's the flag.</p>
            <p>I rated this level as "good"! :3</p>
            <hr>
            <a target="_blank" href="https://play.picoctf.org/practice/challenge/461">https://play.picoctf.org/practice/challenge/461</a>
        </section>
        <section class="link-list">
            <h2>Explore My Website</h2>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/search.html">Search</a></li>
                <li><a href="/articles.html">Articles</a></li>
                <li><a href="/guides.html">Guides</a></li>
            </ul>
            <br><br><br>
        </section>
    </main>
    <footer>
        <p class="cute">Made with ❤️ by Shukularuni</p>
    </footer>
</body>
</html>
