<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OTW Leviathan 3 &#8594; 4 @ Shukularuni</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="icon" type="image/x-icon" href="/icon.png">
</head>
<body>
    <header>
        <h1>OverTheWire Leviathan Guide</h1>
        <p>here's how to solve the leviathan level 3 &#8594; 4</p>
    </header>
    <main>
        <section>
            <a href="./">Back to the Leviathan Guides</a>
            <p>Previous Level Guide: <a href="3.html">Bandit Level 2 &#8594; 3</a></p>
            <hr>
            <h2>Access</h2>
            <p>SSH: <code>ssh leviathan3@leviathan.labs.overthewire.org -p 2223</code></p>
            <p>Password: <code>M4nEAjAXgk</code></p>
            <h2>Info</h2>
            <pre>Description: There is no information for this level, intentionally.</pre>
            <h2>Theory</h2>
            <p>Not much to do with the details from the task, so just skipping to doing it.</p>
            <h2>Solution</h2>
            <p>This level is really similar to the one two levels ago, it's the password checker thing, but now you only have one try instead of three, first we will use ls -la to see all files regardless they are hidden and some details of the files/folders:</p>
            <pre>~$ ls -la
total 40
drwxr-xr-x  2 root       root        4096 Sep 19 07:07 .
drwxr-xr-x 83 root       root        4096 Sep 19 07:09 ..
-rw-r--r--  1 root       root         220 Mar 31  2024 .bash_logout
-rw-r--r--  1 root       root        3771 Mar 31  2024 .bashrc
-r-sr-x---  1 leviathan4 leviathan3 18096 Sep 19 07:07 level3
-rw-r--r--  1 root       root         807 Mar 31  2024 .profile</pre>
            <p>So just like two levels ago, we are going to use ltrace to see if it's checking for a password inside, and know the password we need for it (just remember to hit enter while in ltrace to continue tracing, because you are inside the program at the same time of ltrace tracing):</p>
            <pre>~$ ltrace ./level3
__libc_start_main(0x80490ed, 1, 0xffffd494, 0 <unfinished ...>
strcmp("h0no33", "kakaka")                                                = -1
printf("Enter the password> ")                                            = 20
fgets(Enter the password>
"\n", 256, 0xf7fae5c0)                                              = 0xffffd26c
strcmp("\n", "snlprintf\n")                                               = -1
puts("bzzzzzzzzap. WRONG"bzzzzzzzzap. WRONG
)                                                = 19
+++ exited (status 0) +++</pre>
            <p>Turns out for this one the password is "snlprintf" as we can see fromthe strcmp, not to be confused with the first strcmp that says kakaka. Now let's try with this password:</p>
            <pre>./level3
Enter the password> snlprintf
[You've got shell]!
$ whoami
leviathan4</pre>
            <p>Now we are in the small version of the terminal for the next level, so just like the other level, we'll grab the password from this little thing:</p>
            <pre>$ cat /etc/leviathan_pass/leviathan4
EU7IX6n7em</pre>
            <p>And that's our password! Now you can exit twice because you are inside the small next level terminal, and then go to the next level.</p>
            <a target="_blank" href="https://overthewire.org/wargames/leviathan/leviathan4.html">https://overthewire.org/wargames/leviathan/leviathan4.html</a>
            <hr>
            Next Level Guide: <a href="5.html">Leviathan Level 4 &#8594; Level 5</a>
        </section>
        <section class="link-list">
            <h2>Explore My Website</h2>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/search.html">Search</a></li>
                <li><a href="/articles.html">Articles</a></li>
                <li><a href="/guides.html">Guides</a></li>
            </ul>
            <br><br><br>
        </section>
    </main>
    <footer>
        <p class="cute">Made with ❤️ by Shukularuni</p>
    </footer>
</body>
</html>
